{"ast":null,"code":"var _jsxFileName = \"C:\\\\medicare\\\\frontend\\\\src\\\\components\\\\VideoCall\\\\VideoCallRoom.jsx\",\n  _s = $RefreshSig$();\n// src/components/VideoCall/VideoCallRoom.jsx\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { io } from \"socket.io-client\";\n\n// Update URL if backend is deployed\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io(\"http://localhost:5000\");\nconst VideoCallRoom = ({\n  roomId\n}) => {\n  _s();\n  const localVideoRef = useRef(null);\n  const remoteVideoRef = useRef(null);\n  const peerConnection = useRef(null);\n  const remoteIdRef = useRef(null);\n  const [myId, setMyId] = useState(\"\");\n  useEffect(() => {\n    const setupMediaAndConnection = async () => {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      localVideoRef.current.srcObject = stream;\n      peerConnection.current = new RTCPeerConnection();\n\n      // Send local tracks\n      stream.getTracks().forEach(track => {\n        peerConnection.current.addTrack(track, stream);\n      });\n\n      // Handle remote tracks\n      peerConnection.current.ontrack = event => {\n        remoteVideoRef.current.srcObject = event.streams[0];\n      };\n\n      // ICE Candidate sending\n      peerConnection.current.onicecandidate = event => {\n        if (event.candidate && remoteIdRef.current) {\n          socket.emit(\"send-ice-candidate\", {\n            to: remoteIdRef.current,\n            candidate: event.candidate\n          });\n        }\n      };\n    };\n    setupMediaAndConnection();\n\n    // Socket connection setup\n    socket.on(\"connect\", () => {\n      setMyId(socket.id);\n      socket.emit(\"join-room\", roomId);\n    });\n    socket.on(\"user-joined\", async remoteId => {\n      remoteIdRef.current = remoteId;\n      const offer = await peerConnection.current.createOffer();\n      await peerConnection.current.setLocalDescription(offer);\n      socket.emit(\"send-offer\", {\n        to: remoteId,\n        offer\n      });\n    });\n    socket.on(\"receive-offer\", async ({\n      offer,\n      from\n    }) => {\n      remoteIdRef.current = from;\n      await peerConnection.current.setRemoteDescription(new RTCSessionDescription(offer));\n      const answer = await peerConnection.current.createAnswer();\n      await peerConnection.current.setLocalDescription(answer);\n      socket.emit(\"send-answer\", {\n        to: from,\n        answer\n      });\n    });\n    socket.on(\"receive-answer\", async ({\n      answer\n    }) => {\n      await peerConnection.current.setRemoteDescription(new RTCSessionDescription(answer));\n    });\n    socket.on(\"receive-ice-candidate\", async ({\n      candidate\n    }) => {\n      try {\n        await peerConnection.current.addIceCandidate(new RTCIceCandidate(candidate));\n      } catch (err) {\n        console.error(\"Error adding received ICE candidate\", err);\n      }\n    });\n    return () => {\n      socket.disconnect();\n      if (peerConnection.current) peerConnection.current.close();\n    };\n  }, [roomId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"video-call-room\",\n    style: {\n      display: \"flex\",\n      gap: \"20px\",\n      padding: \"20px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Your Video\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: localVideoRef,\n        autoPlay: true,\n        playsInline: true,\n        muted: true,\n        width: \"400\",\n        height: \"300\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Remote Video\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: remoteVideoRef,\n        autoPlay: true,\n        playsInline: true,\n        width: \"400\",\n        height: \"300\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoCallRoom, \"5lakKD/Bs35oKoft1FTvW/DCSU4=\");\n_c = VideoCallRoom;\nexport default VideoCallRoom;\nvar _c;\n$RefreshReg$(_c, \"VideoCallRoom\");","map":{"version":3,"names":["React","useEffect","useRef","useState","io","jsxDEV","_jsxDEV","socket","VideoCallRoom","roomId","_s","localVideoRef","remoteVideoRef","peerConnection","remoteIdRef","myId","setMyId","setupMediaAndConnection","stream","navigator","mediaDevices","getUserMedia","video","audio","current","srcObject","RTCPeerConnection","getTracks","forEach","track","addTrack","ontrack","event","streams","onicecandidate","candidate","emit","to","on","id","remoteId","offer","createOffer","setLocalDescription","from","setRemoteDescription","RTCSessionDescription","answer","createAnswer","addIceCandidate","RTCIceCandidate","err","console","error","disconnect","close","className","style","display","gap","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","playsInline","muted","width","height","_c","$RefreshReg$"],"sources":["C:/medicare/frontend/src/components/VideoCall/VideoCallRoom.jsx"],"sourcesContent":["// src/components/VideoCall/VideoCallRoom.jsx\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\n\r\n// Update URL if backend is deployed\r\nconst socket = io(\"http://localhost:5000\"); \r\n\r\nconst VideoCallRoom = ({ roomId }) => {\r\n  const localVideoRef = useRef(null);\r\n  const remoteVideoRef = useRef(null);\r\n  const peerConnection = useRef(null);\r\n  const remoteIdRef = useRef(null);\r\n\r\n  const [myId, setMyId] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const setupMediaAndConnection = async () => {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\r\n      localVideoRef.current.srcObject = stream;\r\n\r\n      peerConnection.current = new RTCPeerConnection();\r\n\r\n      // Send local tracks\r\n      stream.getTracks().forEach(track => {\r\n        peerConnection.current.addTrack(track, stream);\r\n      });\r\n\r\n      // Handle remote tracks\r\n      peerConnection.current.ontrack = (event) => {\r\n        remoteVideoRef.current.srcObject = event.streams[0];\r\n      };\r\n\r\n      // ICE Candidate sending\r\n      peerConnection.current.onicecandidate = (event) => {\r\n        if (event.candidate && remoteIdRef.current) {\r\n          socket.emit(\"send-ice-candidate\", {\r\n            to: remoteIdRef.current,\r\n            candidate: event.candidate,\r\n          });\r\n        }\r\n      };\r\n    };\r\n\r\n    setupMediaAndConnection();\r\n\r\n    // Socket connection setup\r\n    socket.on(\"connect\", () => {\r\n      setMyId(socket.id);\r\n      socket.emit(\"join-room\", roomId);\r\n    });\r\n\r\n    socket.on(\"user-joined\", async (remoteId) => {\r\n      remoteIdRef.current = remoteId;\r\n\r\n      const offer = await peerConnection.current.createOffer();\r\n      await peerConnection.current.setLocalDescription(offer);\r\n\r\n      socket.emit(\"send-offer\", { to: remoteId, offer });\r\n    });\r\n\r\n    socket.on(\"receive-offer\", async ({ offer, from }) => {\r\n      remoteIdRef.current = from;\r\n\r\n      await peerConnection.current.setRemoteDescription(new RTCSessionDescription(offer));\r\n      const answer = await peerConnection.current.createAnswer();\r\n      await peerConnection.current.setLocalDescription(answer);\r\n\r\n      socket.emit(\"send-answer\", { to: from, answer });\r\n    });\r\n\r\n    socket.on(\"receive-answer\", async ({ answer }) => {\r\n      await peerConnection.current.setRemoteDescription(new RTCSessionDescription(answer));\r\n    });\r\n\r\n    socket.on(\"receive-ice-candidate\", async ({ candidate }) => {\r\n      try {\r\n        await peerConnection.current.addIceCandidate(new RTCIceCandidate(candidate));\r\n      } catch (err) {\r\n        console.error(\"Error adding received ICE candidate\", err);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect();\r\n      if (peerConnection.current) peerConnection.current.close();\r\n    };\r\n  }, [roomId]);\r\n\r\n  return (\r\n    <div className=\"video-call-room\" style={{ display: \"flex\", gap: \"20px\", padding: \"20px\" }}>\r\n      <div>\r\n        <h3>Your Video</h3>\r\n        <video ref={localVideoRef} autoPlay playsInline muted width=\"400\" height=\"300\" />\r\n      </div>\r\n      <div>\r\n        <h3>Remote Video</h3>\r\n        <video ref={remoteVideoRef} autoPlay playsInline width=\"400\" height=\"300\" />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoCallRoom;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}